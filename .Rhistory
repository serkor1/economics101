equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
equilibrium_plot(
demand,
supply
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = 1
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = 1,
ymin = 2,
ymax = 4
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = c(1,2),
ymin = 2,
ymax = 4
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = c(1,2),
ymin = supply$y,
ymax = 10
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = c(1,2),
ymin = supply$y[1:2],
ymax = 10
)
supply$y[1:2]
supply$y
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x[1:2],
ymin = supply$y[1:2],
ymax = 10
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Consumer Surplus"
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus"
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus"
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus"
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus",
fillcolor = "steelblue"
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus",
color = "steelblue"
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus",
fillcolor = "darkred"
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus",
fillcolor = "steelblue"
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus",
fillcolor = "darkred"
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus",
fillcolor = "steelblue"
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus",
fillcolor = "darkred",
alpha = 0.2
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus",
fillcolor = "steelblue"
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus",
marker = list(
fillcolor = "darkred"
)
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus",
fillcolor = "steelblue"
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus",
fillcolor = "darkred",
opacity = 0.2
)
equilibrium_plot(
demand,
supply
) %>% add_ribbons(
x = supply$x,
ymin = supply$y,
ymax = 10,
name = "Producer Surplus",
fillcolor = "steelblue",
opacity = 0.2
) %>% add_ribbons(
x = demand$x,
ymin = 10,
ymax = demand$y,
name = "Consumer Surplus",
fillcolor = "darkred",
opacity = 0.2
)
source("~/Documents/Economics/scripts/functions.R")
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot <- function(demand, supply) {
# Demand Curve
demand_curve <- demand
supply_curve <- supply
# Remove Everything
# Original Intersections;
# between the initial values
intersection <- intersection_function(
curve_1 = demand_curve,
curve_2 = supply_curve
)
base_plot <- plot_ly(
data = supply_curve
) %>% add_lines(
x = ~x,
y = ~y,
line = list(
color = "steelblue"
),
name = "Supply"
) %>% add_lines(
inherit = FALSE,
data    = demand_curve,
x = ~x,
y = ~y,
line = list(
color = "darkred"
),
name = "Demand"
)
# If we add a Shock/Tax to either side
# there will be three variables instead of two.
# In any case there is a movement.
if (ncol(demand_curve)>2){
base_plot <- base_plot %>%
add_lines(
inherit = TRUE,
data    = demand_curve,
x       = ~x,
y       = ~y_old,
line = list(
color = "darkred",
dash  = "dot"
),
name = "Demand"
)
}
if (ncol(supply_curve)>2){
base_plot <- base_plot %>%
add_lines(
inherit = TRUE,
data    = supply_curve,
x       = ~x,
y = ~ y_old,
line = list(
color = "steelblue",
dash  = "dot"
),
name = "Supply"
)
}
base_plot %>% add_segments(
x = 0,
y = intersection$y_int ,
xend = intersection$x_int,
yend = intersection$y_int,
line = list(
color = "gray",
dash  = "dot"
),
showlegend = FALSE
) %>% add_segments(
x = intersection$x_int,
y = 0,
xend = intersection$x_int,
yend = intersection$y_int,
line = list(
color = "gray",
dash = "dot"
),
showlegend = FALSE
) %>% layout(
xaxis = list(
range = c(0,10),
title = "Quantity"
),
yaxis = list(
range = c(0,30),
title = "Price"
)
) %>% add_ribbons(
x = supply_curve$x:intersection$x_int,
ymin = supply_curve$y,
ymax = intersection$y_int,
name = "Producer Surplus",
fillcolor = "steelblue",
opacity = 0.2
) %>% add_ribbons(
x = demand_curve$x:intersection$x_int,
ymin = intersection$y_int,
ymax = demand_curve$y,
name = "Consumer Surplus",
fillcolor = "darkred",
opacity = 0.2
)
}
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
demand %>% filter(x <= 10)
equilibrium_plot(
demand,
supply
)
equilibrium_plot(
demand,
supply
)
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
source("~/Documents/Economics/scripts/functions.R")
equilibrium_plot(
demand,
supply
)
runApp()
source("~/Documents/Economics/scripts/functions.R")
runApp()
runApp()
runApp()
